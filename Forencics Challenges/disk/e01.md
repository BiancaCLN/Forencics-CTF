# Challenge â€” `questions.e01` (Windows Security Questions)
**Category:** Disk / Registry Forensics  
**File:** `questions.e01`  

[â¬…ï¸ Back to index](../README.md)

---

## ðŸ§© Summary
We were given an E01 disk image named **`questions.e01`**, with a hint referring to *â€œquestionsâ€* and *Windows security questions*.  
This pointed toward **Windows 10/11 local password-reset questions**, which are stored in the **SAM** registry hive and encrypted using data from the **SYSTEM** hive.  

Goal: extract these hives, open them with the correct forensic tool, and recover the plaintext security questions and answers without modifying the evidence.

---

## ðŸ§° Tools Used (and why)
- **Autopsy** â€” examine `.E01` and export files safely (recommended GUI).  
- **FTK Imager / Sleuth Kit (ewfmount + icat/fls)** â€” alternate ways to mount/export evidence.  
- **SecurityQuestionsView (NirSoft)** â€” specialized GUI that decrypts and displays Windows security questions/answers from offline SAM+SYSTEM files. (Primary tool for this artifact.)  
- **Registry Explorer (Eric Zimmermann)** â€” manual offline hive browsing, timestamps, and context.  
- **RegRipper / reglookup / Regipy** â€” automated or scriptable registry parsing and searching for verification.  
- `xxd`, `base64`, `strings` â€” small utilities to decode hex/base64 blobs if encountered.  
- (Advanced) DPAPI utilities (`dpapick`, `python-dpapi`) â€” only if DPAPI-protected blobs need decryption and required keys are available.

> **Safety note:** Always work on copies of exported files. Never modify the original evidence image.

---

## ðŸ”Ž What is stored in the evidence
- The E01 image contained an offline Windows installation.  
- The relevant artifacts for security questions live in:
  - `C:\Windows\System32\config\SAM` (encrypted storage of local account artifacts)  
  - `C:\Windows\System32\config\SYSTEM` (system secrets/keys used to decrypt some SAM contents)  
  - Optionally `C:\Windows\System32\config\SOFTWARE` and per-user `NTUSER.DAT` for complementary info.  
- Some auxiliary files may be needed for DPAPI decryption: `C:\Users\<user>\AppData\Roaming\Microsoft\Protect\{SID}\` (master keys).

---

## ðŸ§­ Full Step-by-Step Procedure

### 1) Mount / open the E01 (read-only)
**Autopsy (recommended)**  
1. Create a new case â†’ Add data source â†’ select `questions.e01`.  
2. Allow Autopsy to parse the file system (NTFS).  
3. Use File Manager to browse to `C:\Windows\System32\config\`.

**Command-line alternative (Linux)**  
```bash
# mount the E01 as read-only (example)
mkdir /mnt/ewf
ewfmount questions.e01 /mnt/ewf
# attach the first EWF segment as a loop device (example)
sudo losetup -fP /mnt/ewf/ewf1
# find partition device (e.g., /dev/loop0p1) and mount read-only
sudo mount -o ro /dev/loop0p1 /mnt/image
# or use fls/icat to extract files directly without mounting
